(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[669],{16177:function(e,t,r){"use strict";r.d(t,{Z:function(){return b}});var n=r(62416),a=r(57971),i=r(46138),o=r(14688),s=r(818),f=r(74880),l=r(39040),u=r(82864),c=r(88315),d=r(76342),h=r(6606),m=r(42519),g=e=>{let t=function(e){let t=(0,h.Uu)(),r=[];for(let n=0;n<t.length;n++){let a=t[n],i=m.Z(e,a.id);i.length&&r.push({renderingEngine:a,viewportIds:i.map(e=>e.id)})}return r}(e);t&&t.length&&t.forEach(({renderingEngine:e,viewportIds:t})=>{e.hasBeenDestroyed||e.renderViewports(t)})};function p(e,t){let r=e.length,{rescaleSlope:n,rescaleIntercept:a,suvbw:i}=t;if("PT"===t.modality&&"number"==typeof i)for(let t=0;t<r;t++)e[t]=i*(e[t]*n+a);else for(let t=0;t<r;t++)e[t]=e[t]*n+a;return e}let y=n.Z.Prefetch,{getMinMax:v}=a;class b extends i.Z{constructor(e,t){super(e),this.framesLoaded=0,this.framesProcessed=0,this.cornerstoneImageMetaData=null,this.cancelLoading=()=>{let{loadStatus:e}=this;e&&e.loading&&(e.loading=!1,e.cancelled=!0,this.clearLoadCallbacks(),o.Z.filterRequests(({additionalDetails:e})=>e.volumeId!==this.volumeId))},this.load=(e,t=5)=>{let{imageIds:r,loadStatus:n,numFrames:a}=this;if(!0===n.loading){console.log(`loadVolume: Loading is already in progress for ${this.volumeId}`);return}let{loaded:i}=this.loadStatus,o=r.length;if(i){e&&e({success:!0,framesLoaded:o,framesProcessed:o,numFrames:a,totalNumFrames:o});return}e&&this.loadStatus.callbacks.push(e),this._prefetchImageIds(t)},this.getImageIdsRequests=(e,t,r)=>{let n,a,i;let{loadStatus:o}=this,{cachedFrames:h}=o,{vtkOpenGLTexture:m,imageData:p,metadata:v,volumeId:b}=this,{FrameOfReferenceUID:w}=v,P=t.buffer,E=e.length,I=t.length/E,A=P.byteLength/E;if(t instanceof Uint8Array)n="Uint8Array";else if(t instanceof Float32Array)n="Float32Array";else if(t instanceof Uint16Array)n="Uint16Array";else if(t instanceof Int16Array)n="Int16Array";else throw Error("Unsupported array type");let x=this.imageIds.length;function S(e){(e.framesProcessed>i||e.framesProcessed===e.totalNumFrames)&&(i+=a,g(b)),e.framesProcessed===e.totalNumFrames&&(o.callbacks.forEach(t=>t(e)),(0,s.Z)(f.Z,l.default.IMAGE_VOLUME_LOADING_COMPLETED,{FrameOfReferenceUID:w,volumeId:b}))}i=a=.02*x;let D=(e,t,r)=>{let n=this._imageIdIndexToFrameIndex(t);h[t]=!0,this.framesLoaded++,this.framesProcessed++,m.setUpdatedFrame(n),p.modified(),(0,s.Z)(f.Z,l.default.IMAGE_VOLUME_MODIFIED,{FrameOfReferenceUID:w,imageVolume:e}),this.framesProcessed===x?(o.loaded=!0,o.loading=!1,S({success:!0,imageIdIndex:t,imageId:r,framesLoaded:this.framesLoaded,framesProcessed:this.framesProcessed,numFrames:E,totalNumFrames:x}),o.callbacks=[]):S({success:!0,imageIdIndex:t,imageId:r,framesLoaded:this.framesLoaded,framesProcessed:this.framesProcessed,numFrames:E,totalNumFrames:x})},T=(e,r,n)=>{let a=this._imageIdIndexToFrameIndex(e),i=u.ZP.getCachedImageBasedOnImageURI(r),s=u.ZP.getVolumeContainingImageId(r);if(o.cancelled){console.warn("volume load cancelled, returning for imageIdIndex: ",e);return}if(!i?.image&&!(s&&s.volume!==this))return D(this,e,r);let f=!!i,l=i||s.volume;this.handleImageComingFromCache(l,f,n,t,a,P,D,e,r,B)};function B(e,t,r){this.framesProcessed++,this.framesProcessed===x?(o.loaded=!0,o.loading=!1,S({success:!1,imageId:r,imageIdIndex:t,error:e,framesLoaded:this.framesLoaded,framesProcessed:this.framesProcessed,numFrames:E,totalNumFrames:x}),o.callbacks=[]):S({success:!1,imageId:r,imageIdIndex:t,error:e,framesLoaded:this.framesLoaded,framesProcessed:this.framesProcessed,numFrames:E,totalNumFrames:x}),(0,s.Z)(f.Z,l.default.IMAGE_LOAD_ERROR,{error:e,imageIdIndex:t,imageId:r})}let U=e.map((e,a)=>{let i=this.getImageIdIndex(e);if(h[i]){this.framesLoaded++,this.framesProcessed++;return}let o=c.get("modalityLutModule",e)||{},s=c.get("generalSeriesModule",e)||{},f={rescaleSlope:o.rescaleSlope,rescaleIntercept:o.rescaleIntercept,modality:s.modality};if("PT"===f.modality){let t=c.get("scalingModule",e);t&&(this._addScalingToVolume(t),f.suvbw=t.suvbw)}let l="number"==typeof f.rescaleSlope&&"number"==typeof f.rescaleIntercept;this.isPreScaled=l;let u={targetBuffer:{arrayBuffer:P instanceof ArrayBuffer?void 0:P,offset:a*A,length:I,type:n},skipCreateImage:!0,preScale:{enabled:!0,scalingParameters:f}};return{callLoadImage:(e,r,n)=>d.loadImage(e,n).then(a=>{(function(e,t,r){if(!(e.buffer instanceof ArrayBuffer))return;let n=r.targetBuffer.offset,a=r.targetBuffer.length,i=t.pixelData?t.pixelData:t.getPixelData();try{if(e instanceof Float32Array){let t=new Float32Array(i);if(t.length!==a)throw"Error pixelData length does not match frame length";e.set(t,n/4)}if(e instanceof Int16Array){let t=new Int16Array(i);if(t.length!==a)throw"Error pixelData length does not match frame length";e.set(t,n/2)}if(e instanceof Uint16Array){let t=new Uint16Array(i);if(t.length!==a)throw"Error pixelData length does not match frame length";e.set(t,n/2)}if(e instanceof Uint8Array){let t=new Uint8Array(i);if(t.length!==a)throw"Error pixelData length does not match frame length";e.set(t,n/1)}}catch(e){console.error(e)}})(t,a,n),T(r,e,f)},t=>{B.call(this,t,r,e)}),imageId:e,imageIdIndex:i,options:u,priority:r,requestType:y,additionalDetails:{volumeId:this.volumeId}}});return U},this.imageIds=t.imageIds,this.loadStatus=t.loadStatus,this.numFrames=this._getNumFrames(),this._createCornerstoneImageMetaData()}_getNumFrames(){let{imageIds:e,scalarData:t}=this,r=this.isDynamicVolume()?t.length:1;return e.length/r}_getScalarDataLength(){let{scalarData:e}=this;return this.isDynamicVolume()?e[0].length:e.length}_createCornerstoneImageMetaData(){let{numFrames:e}=this;if(0===e)return;let t=this.sizeInBytes/e,r=this._getScalarDataLength(),n=r/this.numVoxels,a=this.dimensions[0]*this.dimensions[1]*n,{PhotometricInterpretation:i,voiLut:o,VOILUTFunction:s}=this.metadata,f=[],l=[];o&&o.length&&(f=o.map(e=>e.windowCenter),l=o.map(e=>e.windowWidth)),this.cornerstoneImageMetaData={bytesPerImage:t,numComponents:n,pixelsPerImage:a,windowCenter:f,windowWidth:l,color:n>1,rgba:!1,spacing:this.spacing,dimensions:this.dimensions,photometricInterpretation:i,voiLUTFunction:s,invert:"MONOCHROME1"===i}}_imageIdIndexToFrameIndex(e){return e%this.numFrames}getScalarDataArrays(){return this.isDynamicVolume()?this.scalarData:[this.scalarData]}_getScalarDataByImageIdIndex(e){if(e<0||e>=this.imageIds.length)throw Error("imageIdIndex out of range");let t=Math.floor(e/this.numFrames);return this.getScalarDataArrays()[t]}invalidateVolume(e){let{imageData:t,vtkOpenGLTexture:r}=this,{numFrames:n}=this;for(let e=0;e<n;e++)r.setUpdatedFrame(e);t.modified(),e&&g(this.volumeId)}clearLoadCallbacks(){this.loadStatus.callbacks=[]}handleImageComingFromCache(e,t,r,n,a,i,o,s,f,l){let u=t?e.imageLoadObject:e.convertToCornerstoneImage(f,s);u.promise.then(e=>{let t=this._scaleIfNecessary(e,r),{pixelsPerImage:l,bytesPerImage:u}=this.cornerstoneImageMetaData,c=n.constructor,d=u*a,h=u/l;n.BYTES_PER_ELEMENT!==h&&(d*=n.BYTES_PER_ELEMENT/h);let m=new c(i,d,l);m.set(t),o(this,s,f)}).catch(e=>{l.call(this,e,s,f)})}getImageLoadRequests(e){throw Error("Abstract method")}_prefetchImageIds(e){this.loadStatus.loading=!0;let t=this.getImageLoadRequests(e);t.reverse().forEach(e=>{if(!e)return;let{callLoadImage:t,imageId:r,imageIdIndex:n,options:a,priority:i,requestType:s,additionalDetails:f}=e;o.Z.addRequest(t.bind(this,r,n,a),s,f,i)})}_scaleIfNecessary(e,t){let r=e.preScale?.scaled,n=!t||!t.rescaleIntercept||!t.rescaleSlope;if(!r&&n)return e.getPixelData().slice(0);if(!r&&t&&void 0!==t.rescaleIntercept&&void 0!==t.rescaleSlope){let r=e.getPixelData().slice(0),n=p(r,t);return n}let{rescaleSlope:a,rescaleIntercept:i,suvbw:o}=t,{rescaleSlope:s,rescaleIntercept:f,suvbw:l}=e.preScale.scalingParameters;if(a===s&&i===f&&o===l)return e.getPixelData();let u=e.getPixelData().slice(0),c=a/s,d={...t,rescaleSlope:c,rescaleIntercept:i-f*c,suvbw:o/l},h=p(u,d);return h}_addScalingToVolume(e){if(this.scaling)return;let{suvbw:t,suvlbm:r,suvbsa:n}=e,a={};r&&(a.suvbwToSuvlbm=r/t),n&&(a.suvbwToSuvbsa=n/t),t&&(a.suvbw=t),this.scaling={PT:a}}_removeFromCache(){u.ZP.removeVolumeLoadObject(this.volumeId)}getCornerstoneImage(e,t){let{imageIds:r}=this,n=this._imageIdIndexToFrameIndex(t),{bytesPerImage:a,pixelsPerImage:i,windowCenter:o,windowWidth:s,numComponents:f,color:l,dimensions:u,spacing:d,invert:h,voiLUTFunction:m,photometricInterpretation:g}=this.cornerstoneImageMetaData,p=this._getScalarDataByImageIdIndex(t),y=p.buffer,b=p.constructor,w=a/i,P=a*n;p.BYTES_PER_ELEMENT!==w&&(P*=p.BYTES_PER_ELEMENT/w);let E=new b(i),I=new b(y,P,i);E.set(I);let A=r[t],x=c.get("modalityLutModule",A)||{},S=v(E),D=x.rescaleIntercept?x.rescaleIntercept:0;return{imageId:e,intercept:D,windowCenter:o,windowWidth:s,voiLUTFunction:m,color:l,rgba:!1,numComps:f,rows:u[1],columns:u[0],sizeInBytes:E.byteLength,getPixelData:()=>E,minPixelValue:S.min,maxPixelValue:S.max,slope:x.rescaleSlope?x.rescaleSlope:1,getCanvas:void 0,height:u[0],width:u[1],columnPixelSpacing:d[0],rowPixelSpacing:d[1],invert:h,photometricInterpretation:g}}convertToCornerstoneImage(e,t){return this.getCornerstoneImageLoadObject(e,t)}getCornerstoneImageLoadObject(e,t){let r=this.getCornerstoneImage(e,t),n={promise:Promise.resolve(r)};return n}getCornerstoneImages(){let{imageIds:e}=this;return e.map((e,t)=>this.getCornerstoneImage(e,t))}_convertToImages(){let e=this.sizeInBytes,t=this.imageIds.length,{bytesPerImage:r}=this.cornerstoneImageMetaData,n=u.ZP.decacheIfNecessaryUntilBytesAvailable(e,this.imageIds);for(let e=0;e<t;e++){let t=this.imageIds[e];n-=r;let a=this.convertToCornerstoneImage(t,e);if(u.ZP.getImageLoadObject(t)||u.ZP.putImageLoadObject(t,a).catch(e=>{console.error(e)}),n<=r)break}this._removeFromCache()}decache(e=!1){e?this._removeFromCache():this._convertToImages()}}},86515:function(e,t,r){"use strict";r.d(t,{Z:function(){return y}});var n=r(88315);let a=(e,t)=>e.reduce((e,r)=>((e[r[t]]=e[r[t]]||[]).push(r),e),{});function i(e){let t=e.map(e=>{let t=n.get("petImageModule",e),{frameReferenceTime:r=0}=t??{};return{imageId:e,frameReferenceTime:r}}),r=a(t,"frameReferenceTime"),i=Object.keys(r).map(Number.parseFloat).sort((e,t)=>e-t),o=i.map(e=>r[e].map(e=>e.imageId));return o}var o=function(e){let t=[i];for(let r=0;r<t.length;r++){let n=t[r](e);if(!n||n.length<=1)continue;let a=n[0].length,i=n.every(e=>e.length===a);if(i)return n}return[e]},s=r(57971),f=r(82864),l=r(39040),u=r(77160),c=r(58647),d=r(57945);let{createUint8SharedArray:h,createFloat32SharedArray:m}=s;var g=r(16177);class p extends g.Z{constructor(e,t){p._ensureValidData(e,t),super(e,t),this._timePointIndex=0,this._getTimePointRequests=(e,t)=>{let{imageIds:r,scalarData:n}=e;return this.getImageIdsRequests(r,n,t)},this._getTimePointsRequests=e=>{let t=this._getTimePointsToLoad(),r=[];return t.forEach(t=>{let n=this._getTimePointRequests(t,e);r=r.concat(n)}),r},this.getImageLoadRequests=e=>this._getTimePointsRequests(e).reverse(),this._numTimePoints=this.scalarData.length,this._timePoints=this._getTimePointsData()}static _ensureValidData(e,t){let r=t.imageIds,n=e.scalarData;if(r.length%n.length!=0)throw Error(`Number of imageIds is not a multiple of ${n.length}`)}_getTimePointsData(){let{imageIds:e}=this,t=this.scalarData,{numFrames:r}=this,n=t.length,a=[];for(let i=0;i<n;i++){let n=i*r,o=n+r;a.push({imageIds:e.slice(n,o),scalarData:t[i]})}return a}_getTimePointsToLoad(){let e=this._timePoints,t=this._timePointIndex,r=[e[t]],n=t-1,a=t+1;for(;n>=0||a<e.length;)n>=0&&r.push(e[n--]),a<e.length&&r.push(e[a++]);return r}isDynamicVolume(){return!0}get timePointIndex(){return this._timePointIndex}set timePointIndex(e){if(e<0||e>=this.numTimePoints)throw Error(`Invalid timePointIndex (${e})`);if(this._timePointIndex===e)return;let{imageData:t}=this;this._timePointIndex=e,t.getPointData().setActiveScalars(`timePoint-${e}`),this.invalidateVolume(!0)}get numTimePoints(){return this._numTimePoints}getScalarData(){return this.scalarData[this._timePointIndex]}}var y=function(e,t){if(!t||!t.imageIds||!t.imageIds.length)throw Error("ImageIds must be provided to create a 4D streaming image volume");let{imageIds:r}=t,n=function(e){let t=o(e);return t.map(e=>(function(e){let t;let r=(0,c.Z)(e),{BitsAllocated:n,PixelRepresentation:a,PhotometricInterpretation:i,ImageOrientationPatient:o,PixelSpacing:s,Columns:g,Rows:p}=r,y=u.fromValues(o[0],o[1],o[2]),v=u.fromValues(o[3],o[4],o[5]),b=u.create();u.cross(b,y,v);let{zSpacing:w,origin:P,sortedImageIds:E}=(0,d.Z)(e,b),I=e.length,A=[s[1],s[0],w],x=[g,p,I],S=[...y,...v,...b],D=(16===n?4:1)*x[0]*x[1]*x[2],T=1;"RGB"===i&&(T=3);let B=D*T,U=f.ZP.isCacheable(B);if(!U)throw Error(l.default.CACHE_SIZE_EXCEEDED);switch(f.ZP.decacheIfNecessaryUntilBytesAvailable(B),n){case 8:if(1===a)throw Error("8 Bit signed images are not yet supported by this plugin.");t=h(x[0]*x[1]*x[2]);break;case 16:t=m(x[0]*x[1]*x[2]);break;case 24:t=h(x[0]*x[1]*x[2]*T)}return{metadata:r,sortedImageIds:E,dimensions:x,spacing:A,origin:P,direction:S,scalarData:t,sizeInBytes:B}})(e))}(r),{metadata:a,dimensions:i,spacing:s,origin:g,direction:y,sizeInBytes:v}=n[0],b=[],w=[];n.forEach(e=>{b.push(e.sortedImageIds),w.push(e.scalarData)});let P=new p({volumeId:e,metadata:a,dimensions:i,spacing:s,origin:g,direction:y,scalarData:w,sizeInBytes:v},{imageIds:b.flat(),loadStatus:{loaded:!1,loading:!1,cancelled:!1,cachedFrames:[],callbacks:[]}});return{promise:Promise.resolve(P),decache:()=>{P.destroy(),P=null},cancel:()=>{P.cancelLoading()}}}},56686:function(e,t,r){"use strict";r.d(t,{Z:function(){return w}});var n=r(57971),a=r(64060),i=r(14688),o=r(76342),s=r(62416),f=r(3295),l=r(82864),u=r(39040),c=r(77160),d=r(58647),h=r(57945),m=r(16177);class g extends m.Z{constructor(e,t){super(e,t),this.getImageLoadRequests=e=>{let{imageIds:t}=this,r=this.scalarData;return this.getImageIdsRequests(t,r,e)}}getScalarData(){return this.scalarData}}let{createUint8SharedArray:p,createFloat32SharedArray:y,createUint16SharedArray:v,createInt16SharedArray:b}=n;var w=function(e,t){if(!t||!t.imageIds||!t.imageIds.length)throw Error("ImageIds must be provided to create a streaming image volume");let{useNorm16Texture:r,preferSizeOverAccuracy:n}=(0,a.P_)().rendering,m=r||n;async function w(){let r,n;if("wadouri"===t.imageIds[0].split(":")[0]){let[r,n]=[Math.floor(t.imageIds.length/2),t.imageIds.length-1];await Promise.all([0,r,n].map(r=>new Promise((n,a)=>{let f=t.imageIds[r];i.Z.addRequest(async()=>{o.loadImage(f).then(()=>{console.log(`Prefetched imageId: ${f}`),n(!0)}).catch(e=>{a(e)})},s.Z.Prefetch,{volumeId:e},1)}))).catch(console.error)}let{imageIds:w}=t,P=(0,d.Z)(w),E=Math.floor(w.length/2),I=w[E],A=f.Z(I),x=A.rescaleIntercept<0||A.rescaleSlope<0,{BitsAllocated:S,PixelRepresentation:D,PhotometricInterpretation:T,ImageOrientationPatient:B,PixelSpacing:U,Columns:O,Rows:L}=P,F=c.fromValues(B[0],B[1],B[2]),k=c.fromValues(B[3],B[4],B[5]),C=c.create();c.cross(C,F,k);let{zSpacing:_,origin:M,sortedImageIds:q}=(0,h.Z)(w,C),R=w.length,N=[U[1],U[0],_],Z=[O,L,R],V=[...F,...k,...C],j=1===D,z="RGB"===T?3:1,G=(0,a.hG)(),J=Z[0]*Z[1]*Z[2],Y=e=>{if(!l.ZP.isCacheable(e))throw Error(u.default.CACHE_SIZE_EXCEEDED);l.ZP.decacheIfNecessaryUntilBytesAvailable(e)};switch(S){case 8:if(j)throw Error("8 Bit signed images are not yet supported by this plugin.");Y(n=J*z),r=G?p(J*z):new Uint8Array(J*z);break;case 16:if(!m){n=4*J,r=G?y(J):new Float32Array(J);break}if(n=2*J,j||x){Y(n),r=G?b(J):new Int16Array(J);break}if(!j&&!x){Y(n),r=G?v(J):new Uint16Array(J);break}Y(n=4*J),r=G?y(J):new Float32Array(J);break;case 24:Y(n=J*z),r=G?p(J*z):new Uint8Array(J*z)}let H=new g({volumeId:e,metadata:P,dimensions:Z,spacing:N,origin:M,direction:V,scalarData:r,sizeInBytes:n},{imageIds:q,loadStatus:{loaded:!1,loading:!1,cancelled:!1,cachedFrames:[],callbacks:[]}});return H}let P=w();return{promise:P,decache:()=>{P.then(e=>{e.destroy(),e=null})},cancel:()=>{P.then(e=>{e.cancelLoading()})}}}},58647:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});var n=r(88315);function a(e){let t;let r=e[0],{pixelRepresentation:a,bitsAllocated:i,bitsStored:o,highBit:s,photometricInterpretation:f,samplesPerPixel:l}=n.get("imagePixelModule",r),u=[],c=n.get("voiLutModule",r);if(c){let{windowWidth:e,windowCenter:r}=c;if(t=c?.voiLUTFunction,Array.isArray(e))for(let t=0;t<e.length;t++)u.push({windowWidth:e[t],windowCenter:r[t]});else u.push({windowWidth:e,windowCenter:r})}else u.push({windowWidth:void 0,windowCenter:void 0});let{modality:d,seriesInstanceUID:h}=n.get("generalSeriesModule",r),{imageOrientationPatient:m,pixelSpacing:g,frameOfReferenceUID:p,columns:y,rows:v}=n.get("imagePlaneModule",r);return{BitsAllocated:i,BitsStored:o,SamplesPerPixel:l,HighBit:s,PhotometricInterpretation:f,PixelRepresentation:a,Modality:d,ImageOrientationPatient:m,PixelSpacing:g,FrameOfReferenceUID:p,Columns:y,Rows:v,voiLut:u,VOILUTFunction:t,SeriesInstanceUID:h}}},57945:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});var n=r(77160),a=r(88315),i=r(64060);function o(e,t){let r,o;let{imagePositionPatient:s}=a.get("imagePlaneModule",e[0]),f=n.create(),l="wadouri"===e[0].split(":")[0];function u(e){let{imagePositionPatient:r}=a.get("imagePlaneModule",e),i=n.create();return n.sub(i,s,r),n.dot(i,t)}if(n.set(f,s[0],s[1],s[2]),l){let i=[e[0],e[Math.floor(e.length/2)]];r=e;let f=u(i[0]),l=u(i[1]);f-l<0&&r.reverse();let c=a.get("imagePlaneModule",i[1]);if(!c)throw Error("Incomplete metadata required for volume construction.");let d=n.create();n.sub(d,s,c.imagePositionPatient);let h=n.dot(d,t);o=Math.abs(h)/Math.floor(e.length/2)}else{let t=e.map(e=>{let t=u(e);return{distance:t,imageId:e}});t.sort((e,t)=>t.distance-e.distance),r=t.map(e=>e.imageId);let n=t.length;o=Math.abs(t[n-1].distance-t[0].distance)/(n-1)}let{imagePositionPatient:c,sliceThickness:d}=a.get("imagePlaneModule",r[0]),{strictZSpacingForVolumeViewport:h}=(0,i.P_)().rendering;0!==o||h||(d?(console.log("Could not calculate zSpacing. Using sliceThickness"),o=d):(console.log("Could not calculate zSpacing. The VolumeViewport visualization is compromised. Setting zSpacing to 1 to render"),o=1));let m={zSpacing:o,origin:c,sortedImageIds:r};return m}},34705:function(e,t,r){var n=r(21876).Buffer,a=r(83454);e.exports=function(e){var t,r;return t=[function(t,r){t.exports=e},function(e,t,r){"use strict";r.r(t),r.d(t,"isStringVr",function(){return o}),r.d(t,"isPrivateTag",function(){return s}),r.d(t,"parsePN",function(){return f}),r.d(t,"parseTM",function(){return l}),r.d(t,"parseDA",function(){return u}),r.d(t,"explicitElementToString",function(){return c}),r.d(t,"explicitDataSetToJS",function(){return d}),r.d(t,"createJPEGBasicOffsetTable",function(){return m}),r.d(t,"parseDicomDataSetExplicit",function(){return U}),r.d(t,"parseDicomDataSetImplicit",function(){return O}),r.d(t,"readFixedString",function(){return v}),r.d(t,"alloc",function(){return L}),r.d(t,"version",function(){return F}),r.d(t,"bigEndianByteArrayParser",function(){return k}),r.d(t,"ByteStream",function(){return M}),r.d(t,"sharedCopy",function(){return C}),r.d(t,"DataSet",function(){return P}),r.d(t,"findAndSetUNElementLength",function(){return y}),r.d(t,"findEndOfEncapsulatedElement",function(){return p}),r.d(t,"findItemDelimitationItemAndSetElementLength",function(){return E}),r.d(t,"littleEndianByteArrayParser",function(){return q}),r.d(t,"parseDicom",function(){return N}),r.d(t,"readDicomElementExplicit",function(){return B}),r.d(t,"readDicomElementImplicit",function(){return I}),r.d(t,"readEncapsulatedImageFrame",function(){return G}),r.d(t,"readEncapsulatedPixelData",function(){return Y}),r.d(t,"readEncapsulatedPixelDataFromFragments",function(){return V}),r.d(t,"readPart10Header",function(){return R}),r.d(t,"readSequenceItemsExplicit",function(){return T}),r.d(t,"readSequenceItemsImplicit",function(){return S}),r.d(t,"readSequenceItem",function(){return A}),r.d(t,"readTag",function(){return g});var i={AE:!0,AS:!0,AT:!1,CS:!0,DA:!0,DS:!0,DT:!0,FL:!1,FD:!1,IS:!0,LO:!0,LT:!0,OB:!1,OD:!1,OF:!1,OW:!1,PN:!0,SH:!0,SL:!1,SQ:!1,SS:!1,ST:!0,TM:!0,UI:!0,UL:!1,UN:void 0,UR:!0,US:!1,UT:!0},o=function(e){return i[e]},s=function(e){if(isNaN(e=parseInt(e[4],16)))throw"dicomParser.isPrivateTag: cannot parse last character of group";return e%2==1},f=function(e){if(void 0!==e)return{familyName:(e=e.split("^"))[0],givenName:e[1],middleName:e[2],prefix:e[3],suffix:e[4]}};function l(e,t){if(2<=e.length){var r=parseInt(e.substring(0,2),10),n=4<=e.length?parseInt(e.substring(2,4),10):void 0,a=6<=e.length?parseInt(e.substring(4,6),10):void 0,i=8<=e.length?e.substring(7,13):void 0,i=i?parseInt(i,10)*Math.pow(10,6-i.length):void 0;if(t&&(isNaN(r)||void 0!==n&&isNaN(n)||void 0!==a&&isNaN(a)||void 0!==i&&isNaN(i)||r<0||23<r||n&&(n<0||59<n)||a&&(a<0||59<a)||i&&(i<0||999999<i)))throw"invalid TM '".concat(e,"'");return{hours:r,minutes:n,seconds:a,fractionalSeconds:i}}if(t)throw"invalid TM '".concat(e,"'")}function u(e,t){if(e&&8===e.length){var r=parseInt(e.substring(0,4),10),n=parseInt(e.substring(4,6),10),a=parseInt(e.substring(6,8),10);if(t&&!0!=(!isNaN(r)&&0<n&&n<=12&&0<a&&a<=function(e,t){switch(e){case 2:return t%4==0&&t%100||t%400==0?29:28;case 9:case 4:case 6:case 11:return 30;default:return 31}}(n,r)))throw"invalid DA '".concat(e,"'");return{year:r,month:n,day:a}}if(t)throw"invalid DA '".concat(e,"'")}function c(e,t){if(void 0===e||void 0===t)throw"dicomParser.explicitElementToString: missing required parameters";if(void 0===t.vr)throw"dicomParser.explicitElementToString: cannot convert implicit element to string";var r,n=t.vr,a=t.tag;function i(t,r){for(var n="",i=0;i<t;i++)0!==i&&(n+="/"),n+=r.call(e,a,i).toString();return n}if(!0===o(n))r=e.string(a);else{if("AT"===n){var s=e.uint32(a);return void 0===s?void 0:"x".concat((s=s<0?4294967295+s+1:s).toString(16).toUpperCase())}"US"===n?r=i(t.length/2,e.uint16):"SS"===n?r=i(t.length/2,e.int16):"UL"===n?r=i(t.length/4,e.uint32):"SL"===n?r=i(t.length/4,e.int32):"FD"===n?r=i(t.length/8,e.double):"FL"===n&&(r=i(t.length/4,e.float))}return r}function d(e,t){if(void 0===e)throw"dicomParser.explicitDataSetToJS: missing required parameter dataSet";t=t||{omitPrivateAttibutes:!0,maxElementLength:128};var r,n={};for(r in e.elements){var a=e.elements[r];if(!0!==t.omitPrivateAttibutes||!s(r)){if(a.items){for(var i=[],o=0;o<a.items.length;o++)i.push(d(a.items[o].dataSet,t));n[r]=i}else{var f=void 0;a.length<t.maxElementLength&&(f=c(e,a)),n[r]=void 0!==f?f:{dataOffset:a.dataOffset,length:a.length}}}}return n}function h(e,t){return 255===e.byteArray[t]&&217===e.byteArray[t+1]}function m(e,t,r){if(void 0===e)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter dataSet";if(void 0===t)throw"dicomParser.createJPEGBasicOffsetTable: missing required parameter pixelDataElement";if("x7fe00010"!==t.tag)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010'";if(!0!==t.encapsulatedPixelData||!0!==t.hadUndefinedLength||void 0===t.basicOffsetTable||void 0===t.fragments||t.fragments.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(r&&r.length<=0)throw"dicomParser.createJPEGBasicOffsetTable: parameter 'fragments' must not be zero length";r=r||t.fragments;for(var n=[],a=0;;){n.push(t.fragments[a].offset);var i=function(e,t,r){for(var n,a=r;a<t.fragments.length;a++)if(n=a,!(!h(e,(n=t.fragments[n]).position+n.length-2)&&!h(e,n.position+n.length-3)))return a}(e,t,a);if(void 0===i||i===t.fragments.length-1)return n;a=i+1}}function g(e){if(void 0===e)throw"dicomParser.readTag: missing required parameter 'byteStream'";var t=256*e.readUint16()*256,e=e.readUint16();return"x".concat("00000000".concat((t+e).toString(16)).substr(-8))}function p(e,t,r){if(void 0===e)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.findEndOfEncapsulatedElement: missing required parameter 'element'";if(t.encapsulatedPixelData=!0,t.basicOffsetTable=[],t.fragments=[],"xfffee000"!==g(e))throw"dicomParser.findEndOfEncapsulatedElement: basic offset table not found";for(var n=e.readUint32()/4,a=0;a<n;a++){var i=e.readUint32();t.basicOffsetTable.push(i)}for(var o=e.position;e.position<e.byteArray.length;){var s=g(e),f=e.readUint32();if("xfffee0dd"===s)return e.seek(f),void(t.length=e.position-t.dataOffset);if("xfffee000"!==s)return r&&r.push("unexpected tag ".concat(s," while searching for end of pixel data element with undefined length")),f>e.byteArray.length-e.position&&(f=e.byteArray.length-e.position),t.fragments.push({offset:e.position-o-8,position:e.position,length:f}),e.seek(f),void(t.length=e.position-t.dataOffset);t.fragments.push({offset:e.position-o-8,position:e.position,length:f}),e.seek(f)}r&&r.push("pixel data element ".concat(t.tag," missing sequence delimiter tag xfffee0dd"))}function y(e,t){if(void 0===e)throw"dicomParser.findAndSetUNElementLength: missing required parameter 'byteStream'";for(var r=e.byteArray.length-8;e.position<=r;)if(65534===e.readUint16()&&57565===e.readUint16())return 0!==e.readUint32()&&e.warnings("encountered non zero length following item delimiter at position ".concat(e.position-4," while reading element of undefined length with tag ").concat(t.tag)),void(t.length=e.position-t.dataOffset);t.length=e.byteArray.length-t.dataOffset,e.seek(e.byteArray.length-e.position)}function v(e,t,r){if(r<0)throw"dicomParser.readFixedString - length cannot be less than 0";if(t+r>e.length)throw"dicomParser.readFixedString: attempt to read past end of buffer";for(var n,a="",i=0;i<r;i++){if(0===(n=e[t+i]))return t+=r,a;a+=String.fromCharCode(n)}return a}function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function w(e,t){return void 0!==e.parser?e.parser:t}var P=function(){var e,t;function r(e,t,n){(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,r),this.byteArrayParser=e,this.byteArray=t,this.elements=n}return e=[{key:"uint16",value:function(e,t){if(t=void 0!==t?t:0,(e=this.elements[e])&&0!==e.length)return w(e,this.byteArrayParser).readUint16(this.byteArray,e.dataOffset+2*t)}},{key:"int16",value:function(e,t){if(t=void 0!==t?t:0,(e=this.elements[e])&&0!==e.length)return w(e,this.byteArrayParser).readInt16(this.byteArray,e.dataOffset+2*t)}},{key:"uint32",value:function(e,t){if(t=void 0!==t?t:0,(e=this.elements[e])&&0!==e.length)return w(e,this.byteArrayParser).readUint32(this.byteArray,e.dataOffset+4*t)}},{key:"int32",value:function(e,t){if(t=void 0!==t?t:0,(e=this.elements[e])&&0!==e.length)return w(e,this.byteArrayParser).readInt32(this.byteArray,e.dataOffset+4*t)}},{key:"float",value:function(e,t){if(t=void 0!==t?t:0,(e=this.elements[e])&&0!==e.length)return w(e,this.byteArrayParser).readFloat(this.byteArray,e.dataOffset+4*t)}},{key:"double",value:function(e,t){if(t=void 0!==t?t:0,(e=this.elements[e])&&0!==e.length)return w(e,this.byteArrayParser).readDouble(this.byteArray,e.dataOffset+8*t)}},{key:"numStringValues",value:function(e){if((e=this.elements[e])&&0<e.length)return null===(e=v(this.byteArray,e.dataOffset,e.length).match(/\\/g))?1:e.length+1}},{key:"string",value:function(e,t){return(e=this.elements[e])&&e.Value?e.Value:e&&0<e.length?(e=v(this.byteArray,e.dataOffset,e.length),0<=t?e.split("\\")[t].trim():e.trim()):void 0}},{key:"text",value:function(e,t){if((e=this.elements[e])&&0<e.length)return e=v(this.byteArray,e.dataOffset,e.length),0<=t?e.split("\\")[t].replace(/ +$/,""):e.replace(/ +$/,"")}},{key:"floatString",value:function(e,t){var r=this.elements[e];if(r&&0<r.length&&void 0!==(t=this.string(e,t=void 0!==t?t:0)))return parseFloat(t)}},{key:"intString",value:function(e,t){var r=this.elements[e];if(r&&0<r.length&&void 0!==(t=this.string(e,t=void 0!==t?t:0)))return parseInt(t)}},{key:"attributeTag",value:function(e){var t=this.elements[e];if(t&&4===t.length){var r=w(t,this.byteArrayParser).readUint16,e=this.byteArray,t=t.dataOffset;return"x".concat("00000000".concat((256*r(e,t)*256+r(e,t+2)).toString(16)).substr(-8))}}}],b(r.prototype,e),t&&b(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}();function E(e,t){if(void 0===e)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";for(var r=e.byteArray.length-8;e.position<=r;)if(65534===e.readUint16()&&57357===e.readUint16())return 0!==e.readUint32()&&e.warnings("encountered non zero length following item delimiter at position ".concat(e.position-4," while reading element of undefined length with tag ").concat(t.tag)),void(t.length=e.position-t.dataOffset);t.length=e.byteArray.length-t.dataOffset,e.seek(e.byteArray.length-e.position)}function I(e,t,r){if(void 0===e)throw"dicomParser.readDicomElementImplicit: missing required parameter 'byteStream'";var n,a=g(e),a={tag:a,vr:void 0!==r?r(a):void 0,length:e.readUint32(),dataOffset:e.position};return 4294967295===a.length&&(a.hadUndefinedLength=!0),a.tag===t||((void 0!==(n=a).vr?"SQ"!==n.vr:e.position+4<=e.byteArray.length?(n=g(e),e.seek(-4),"xfffee000"!==n&&"xfffee0dd"!==n):(e.warnings.push("eof encountered before finding sequence item tag or sequence delimiter tag in peeking to determine VR"),!0))||s(a.tag)&&!a.hadUndefinedLength?a.hadUndefinedLength?E(e,a):e.seek(a.length):(S(e,a,r),s(a.tag)&&(a.items=void 0))),a}function A(e){if(void 0===e)throw"dicomParser.readSequenceItem: missing required parameter 'byteStream'";var t={tag:g(e),length:e.readUint32(),dataOffset:e.position};if("xfffee000"!==t.tag)throw"dicomParser.readSequenceItem: item tag (FFFE,E000) not found at offset ".concat(e.position);return t}function x(e,t){var r=A(e);return 4294967295===r.length?(r.hadUndefinedLength=!0,r.dataSet=function(e,t){for(var r={};e.position<e.byteArray.length;){var n=I(e,void 0,t);if("xfffee00d"===(r[n.tag]=n).tag)return new P(e.byteArrayParser,e.byteArray,r)}return e.warnings.push("eof encountered before finding sequence item delimiter in sequence item of undefined length"),new P(e.byteArrayParser,e.byteArray,r)}(e,t),r.length=e.position-r.dataOffset):(r.dataSet=new P(e.byteArrayParser,e.byteArray,{}),O(r.dataSet,e,e.position+r.length,{vrCallback:t})),r}function S(e,t,r){if(void 0===e)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.readSequenceItemsImplicit: missing required parameter 'element'";t.items=[],(4294967295===t.length?function(e,t,r){for(;e.position+4<=e.byteArray.length;){var n=g(e);if(e.seek(-4),"xfffee0dd"===n)return t.length=e.position-t.dataOffset,e.seek(8);n=x(e,r),t.items.push(n)}e.warnings.push("eof encountered before finding sequence delimiter in sequence of undefined length"),t.length=e.byteArray.length-t.dataOffset}:function(e,t,r){for(var n=t.dataOffset+t.length;e.position<n;){var a=x(e,r);t.items.push(a)}})(e,t,r)}function D(e,t){var r=A(e);return 4294967295===r.length?(r.hadUndefinedLength=!0,r.dataSet=function(e,t){for(var r={};e.position<e.byteArray.length;){var n=B(e,t);if("xfffee00d"===(r[n.tag]=n).tag)return new P(e.byteArrayParser,e.byteArray,r)}return t.push("eof encountered before finding item delimiter tag while reading sequence item of undefined length"),new P(e.byteArrayParser,e.byteArray,r)}(e,t),r.length=e.position-r.dataOffset):(r.dataSet=new P(e.byteArrayParser,e.byteArray,{}),U(r.dataSet,e,e.position+r.length)),r}function T(e,t,r){if(void 0===e)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'byteStream'";if(void 0===t)throw"dicomParser.readSequenceItemsExplicit: missing required parameter 'element'";t.items=[],(4294967295===t.length?function(e,t,r){for(;e.position+4<=e.byteArray.length;){var n=g(e);if(e.seek(-4),"xfffee0dd"===n)return t.length=e.position-t.dataOffset,e.seek(8);n=D(e,r),t.items.push(n)}r.push("eof encountered before finding sequence delimitation tag while reading sequence of undefined length"),t.length=e.position-t.dataOffset}:function(e,t,r){for(var n=t.dataOffset+t.length;e.position<n;){var a=D(e,r);t.items.push(a)}})(e,t,r)}function B(e,t,r){if(void 0===e)throw"dicomParser.readDicomElementExplicit: missing required parameter 'byteStream'";var n,a={tag:g(e),vr:e.readFixedString(2)};return 2==("OB"===(n=a.vr)||"OD"===n||"OL"===n||"OW"===n||"SQ"===n||"OF"===n||"UC"===n||"UR"===n||"UT"===n||"UN"===n?4:2)?a.length=e.readUint16():(e.seek(2),a.length=e.readUint32()),a.dataOffset=e.position,4294967295===a.length&&(a.hadUndefinedLength=!0),a.tag===r||("SQ"===a.vr?T(e,a,t):4294967295===a.length?"x7fe00010"===a.tag?p(e,a,t):("UN"===a.vr?S:E)(e,a):e.seek(a.length)),a}function U(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};if(r=void 0===r?t.byteArray.length:r,void 0===t)throw"dicomParser.parseDicomDataSetExplicit: missing required parameter 'byteStream'";if(r<t.position||r>t.byteArray.length)throw"dicomParser.parseDicomDataSetExplicit: invalid value for parameter 'maxP osition'";for(var a=e.elements;t.position<r;){var i=B(t,e.warnings,n.untilTag);if((a[i.tag]=i).tag===n.untilTag)return}if(t.position>r)throw"dicomParser:parseDicomDataSetExplicit: buffer overrun"}function O(e,t,r){var n=3<arguments.length&&void 0!==arguments[3]?arguments[3]:{};if(r=void 0===r?e.byteArray.length:r,void 0===t)throw"dicomParser.parseDicomDataSetImplicit: missing required parameter 'byteStream'";if(r<t.position||r>t.byteArray.length)throw"dicomParser.parseDicomDataSetImplicit: invalid value for parameter 'maxPosition'";for(var a=e.elements;t.position<r;){var i=I(t,n.untilTag,n.vrCallback);if((a[i.tag]=i).tag===n.untilTag)return}}function L(e,t){if(void 0!==n&&e instanceof n)return n.alloc(t);if(e instanceof Uint8Array)return new Uint8Array(t);throw"dicomParser.alloc: unknown type for byteArray"}var F="1.8.12",k={readUint16:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readUint16: position cannot be less than 0";if(t+2>e.length)throw"bigEndianByteArrayParser.readUint16: attempt to read past end of buffer";return(e[t]<<8)+e[t+1]},readInt16:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readInt16: position cannot be less than 0";if(t+2>e.length)throw"bigEndianByteArrayParser.readInt16: attempt to read past end of buffer";return t=32768&(t=(e[t]<<8)+e[t+1])?t-65535-1:t},readUint32:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readUint32: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readUint32: attempt to read past end of buffer";return 256*(256*(256*e[t]+e[t+1])+e[t+2])+e[t+3]},readInt32:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readInt32: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readInt32: attempt to read past end of buffer";return(e[t]<<24)+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3]},readFloat:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readFloat: position cannot be less than 0";if(t+4>e.length)throw"bigEndianByteArrayParser.readFloat: attempt to read past end of buffer";var r=new Uint8Array(4);return r[3]=e[t],r[2]=e[t+1],r[1]=e[t+2],r[0]=e[t+3],new Float32Array(r.buffer)[0]},readDouble:function(e,t){if(t<0)throw"bigEndianByteArrayParser.readDouble: position cannot be less than 0";if(t+8>e.length)throw"bigEndianByteArrayParser.readDouble: attempt to read past end of buffer";var r=new Uint8Array(8);return r[7]=e[t],r[6]=e[t+1],r[5]=e[t+2],r[4]=e[t+3],r[3]=e[t+4],r[2]=e[t+5],r[1]=e[t+6],r[0]=e[t+7],new Float64Array(r.buffer)[0]}};function C(e,t,r){if(void 0!==n&&e instanceof n)return e.slice(t,t+r);if(e instanceof Uint8Array)return new Uint8Array(e.buffer,e.byteOffset+t,r);throw"dicomParser.from: unknown type for byteArray"}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var M=function(){var e,t;function r(e,t,a){if(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,r),void 0===e)throw"dicomParser.ByteStream: missing required parameter 'byteArrayParser'";if(void 0===t)throw"dicomParser.ByteStream: missing required parameter 'byteArray'";if(t instanceof Uint8Array==!1&&(void 0===n||t instanceof n==!1))throw"dicomParser.ByteStream: parameter byteArray is not of type Uint8Array or Buffer";if(a<0)throw"dicomParser.ByteStream: parameter 'position' cannot be less than 0";if(a>=t.length)throw"dicomParser.ByteStream: parameter 'position' cannot be greater than or equal to 'byteArray' length";this.byteArrayParser=e,this.byteArray=t,this.position=a||0,this.warnings=[]}return e=[{key:"seek",value:function(e){if(this.position+e<0)throw"dicomParser.ByteStream.prototype.seek: cannot seek to position < 0";this.position+=e}},{key:"readByteStream",value:function(e){if(this.position+e>this.byteArray.length)throw"dicomParser.ByteStream.prototype.readByteStream: readByteStream - buffer overread";var t=C(this.byteArray,this.position,e);return this.position+=e,new r(this.byteArrayParser,t)}},{key:"getSize",value:function(){return this.byteArray.length}},{key:"readUint16",value:function(){var e=this.byteArrayParser.readUint16(this.byteArray,this.position);return this.position+=2,e}},{key:"readUint32",value:function(){var e=this.byteArrayParser.readUint32(this.byteArray,this.position);return this.position+=4,e}},{key:"readFixedString",value:function(e){var t=v(this.byteArray,this.position,e);return this.position+=e,t}}],_(r.prototype,e),t&&_(r,t),Object.defineProperty(r,"prototype",{writable:!1}),r}(),q={readUint16:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readUint16: position cannot be less than 0";if(t+2>e.length)throw"littleEndianByteArrayParser.readUint16: attempt to read past end of buffer";return e[t]+256*e[t+1]},readInt16:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readInt16: position cannot be less than 0";if(t+2>e.length)throw"littleEndianByteArrayParser.readInt16: attempt to read past end of buffer";return t=32768&(t=e[t]+(e[t+1]<<8))?t-65535-1:t},readUint32:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readUint32: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readUint32: attempt to read past end of buffer";return e[t]+256*e[t+1]+256*e[t+2]*256+256*e[t+3]*65536},readInt32:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readInt32: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readInt32: attempt to read past end of buffer";return e[t]+(e[t+1]<<8)+(e[t+2]<<16)+(e[t+3]<<24)},readFloat:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readFloat: position cannot be less than 0";if(t+4>e.length)throw"littleEndianByteArrayParser.readFloat: attempt to read past end of buffer";var r=new Uint8Array(4);return r[0]=e[t],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],new Float32Array(r.buffer)[0]},readDouble:function(e,t){if(t<0)throw"littleEndianByteArrayParser.readDouble: position cannot be less than 0";if(t+8>e.length)throw"littleEndianByteArrayParser.readDouble: attempt to read past end of buffer";var r=new Uint8Array(8);return r[0]=e[t],r[1]=e[t+1],r[2]=e[t+2],r[3]=e[t+3],r[4]=e[t+4],r[5]=e[t+5],r[6]=e[t+6],r[7]=e[t+7],new Float64Array(r.buffer)[0]}};function R(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e)throw"dicomParser.readPart10Header: missing required parameter 'byteArray'";var r=t.TransferSyntaxUID,n=new M(q,e);return function(){var e=function(){if(132>=n.getSize()&&r)return!1;if(n.seek(128),"DICM"===n.readFixedString(4))return!0;if(!(t||{}).TransferSyntaxUID)throw"dicomParser.readPart10Header: DICM prefix not found at location 132 - this is not a valid DICOM P10 file.";return n.seek(0),!1}(),a=[],i={};if(!e)return n.position=0,{elements:{x00020010:{tag:"x00020010",vr:"UI",Value:r}},warnings:a};for(;n.position<n.byteArray.length;){var o=n.position,s=B(n,a);if("x0002ffff"<s.tag){n.position=o;break}s.parser=q,i[s.tag]=s}return(e=new P(n.byteArrayParser,n.byteArray,i)).warnings=n.warnings,e.position=n.position,e}()}function N(e){var t=1<arguments.length&&void 0!==arguments[1]?arguments[1]:{};if(void 0===e)throw Error("dicomParser.parseDicom: missing required parameter 'byteArray'");var n,i=function(t){if(void 0===t.elements.x00020010)throw Error("dicomParser.parseDicom: missing required meta header attribute 0002,0010");return(t=t.elements.x00020010)&&t.Value||v(e,t.dataOffset,t.length)};return function(e,t){for(var r in e.elements)e.elements.hasOwnProperty(r)&&(t.elements[r]=e.elements[r]);return void 0!==e.warnings&&(t.warnings=e.warnings.concat(t.warnings)),t}(n=R(e,t),function(n){var o=i(n),s="1.2.840.10008.1.2"!==o,o=function(n,i){var o="[object process]"===Object.prototype.toString.call(void 0!==a?a:0);if("1.2.840.10008.1.2.1.99"!==n)return new M("1.2.840.10008.1.2.2"===n?k:q,e,i);if(t&&t.inflater)return n=t.inflater(e,i),new M(q,n,0);if(!0==o){var s=r(0),f=C(e,i,e.length-i),s=s.inflateRawSync(f),f=L(e,s.length+i);return e.copy(f,0,0,i),s.copy(f,i),new M(q,f,0)}if("undefined"==typeof pako)throw"dicomParser.parseDicom: no inflater available to handle deflate transfer syntax";return s=e.slice(i),f=pako.inflateRaw(s),(s=L(e,f.length+i)).set(e.slice(0,i),0),s.set(f,i),new M(q,s,0)}(o,n.position),n=new P(o.byteArrayParser,o.byteArray,{});n.warnings=o.warnings;try{(s?U:O)(n,o,o.byteArray.length,t)}catch(e){throw{exception:e,dataSet:n}}return n}(n))}var Z=function(e,t,r){for(var n=0,a=t;a<t+r;a++)n+=e[a].length;return n};function V(e,t,r,n,a){if(a=a||t.fragments,void 0===e)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'pixelDataElement'";if(void 0===r)throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'startFragmentIndex'";if(void 0===(n=n||1))throw"dicomParser.readEncapsulatedPixelDataFromFragments: missing required parameter 'numFragments'";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010";if(!0!==t.encapsulatedPixelData||!0!==t.hadUndefinedLength||void 0===t.basicOffsetTable||void 0===t.fragments||t.fragments.length<=0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(r<0)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be >= 0";if(r>=t.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragmentIndex' must be < number of fragments";if(n<1)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'numFragments' must be > 0";if(r+n>t.fragments.length)throw"dicomParser.readEncapsulatedPixelDataFromFragments: parameter 'startFragment' + 'numFragments' < number of fragments";var i=new M(e.byteArrayParser,e.byteArray,t.dataOffset),t=A(i);if("xfffee000"!==t.tag)throw"dicomParser.readEncapsulatedPixelData: missing basic offset table xfffee000";i.seek(t.length);var o=i.position;if(1===n)return C(i.byteArray,o+a[r].offset+8,a[r].length);for(var t=Z(a,r,n),s=L(i.byteArray,t),f=0,l=r;l<r+n;l++)for(var u=o+a[l].offset+8,c=0;c<a[l].length;c++)s[f++]=i.byteArray[u++];return s}var j=function(e,t){for(var r=0;r<e.length;r++)if(e[r].offset===t)return r},z=function(e,t,r,n){if(e===t.length-1)return r.length-n;for(var a=t[e+1],i=n+1;i<r.length;i++)if(r[i].offset===a)return i-n;throw"dicomParser.calculateNumberOfFragmentsForFrame: could not find fragment with offset matching basic offset table"};function G(e,t,r,n,a){if(n=n||t.basicOffsetTable,a=a||t.fragments,void 0===e)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'pixelDataElement'";if(void 0===r)throw"dicomParser.readEncapsulatedImageFrame: missing required parameter 'frameIndex'";if(void 0===n)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' does not have basicOffsetTable";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to non pixel data tag (expected tag = x7fe00010)";if(!0!==t.encapsulatedPixelData)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have encapsulated pixel data";if(!0!==t.hadUndefinedLength)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have undefined length";if(void 0===t.fragments)throw"dicomParser.readEncapsulatedImageFrame: parameter 'pixelDataElement' refers to pixel data element that does not have fragments";if(0===n.length)throw"dicomParser.readEncapsulatedImageFrame: basicOffsetTable has zero entries";if(r<0)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be >= 0";if(r>=n.length)throw"dicomParser.readEncapsulatedImageFrame: parameter 'frameIndex' must be < basicOffsetTable.length";var i=n[r],i=j(a,i);if(void 0===i)throw"dicomParser.readEncapsulatedImageFrame: unable to find fragment that matches basic offset table entry";return V(e,t,i,z(r,n,a,i),a)}var J=!1;function Y(e,t,r){if(J||(J=!0,console&&console.log&&console.log("WARNING: dicomParser.readEncapsulatedPixelData() has been deprecated")),void 0===e)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'dataSet'";if(void 0===t)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'element'";if(void 0===r)throw"dicomParser.readEncapsulatedPixelData: missing required parameter 'frame'";if("x7fe00010"!==t.tag)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to non pixel data tag (expected tag = x7fe00010)";if(!0!==t.encapsulatedPixelData||!0!==t.hadUndefinedLength||void 0===t.basicOffsetTable||void 0===t.fragments)throw"dicomParser.readEncapsulatedPixelData: parameter 'element' refers to pixel data element that does not have encapsulated pixel data";if(r<0)throw"dicomParser.readEncapsulatedPixelData: parameter 'frame' must be >= 0";return 0!==t.basicOffsetTable.length?G(e,t,r):V(e,t,0,t.fragments.length)}t.default={isStringVr:o,isPrivateTag:s,parsePN:f,parseTM:l,parseDA:u,explicitElementToString:c,explicitDataSetToJS:d,createJPEGBasicOffsetTable:m,parseDicomDataSetExplicit:U,parseDicomDataSetImplicit:O,readFixedString:v,alloc:L,version:F,bigEndianByteArrayParser:k,ByteStream:M,sharedCopy:C,DataSet:P,findAndSetUNElementLength:y,findEndOfEncapsulatedElement:p,findItemDelimitationItemAndSetElementLength:E,littleEndianByteArrayParser:q,parseDicom:N,readDicomElementExplicit:B,readDicomElementImplicit:I,readEncapsulatedImageFrame:G,readEncapsulatedPixelData:Y,readEncapsulatedPixelDataFromFragments:V,readPart10Header:R,readSequenceItemsExplicit:T,readSequenceItemsImplicit:S,readSequenceItem:A,readTag:g,LEI:"1.2.840.10008.1.2",LEE:"1.2.840.10008.1.2.1"}}],r={},i.m=t,i.c=r,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,(function(t){return e[t]}).bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=1);function i(e){if(r[e])return r[e].exports;var n=r[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}}(r(23848))},83454:function(e,t,r){"use strict";var n,a;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(a=r.g.process)?void 0:a.env)?r.g.process:r(77663)},21876:function(e){!function(){var t={675:function(e,t){"use strict";t.byteLength=function(e){var t=f(e),r=t[0],n=t[1];return(r+n)*3/4-n},t.toByteArray=function(e){var t,r,i=f(e),o=i[0],s=i[1],l=new a((o+s)*3/4-s),u=0,c=s>0?o-4:o;for(r=0;r<c;r+=4)t=n[e.charCodeAt(r)]<<18|n[e.charCodeAt(r+1)]<<12|n[e.charCodeAt(r+2)]<<6|n[e.charCodeAt(r+3)],l[u++]=t>>16&255,l[u++]=t>>8&255,l[u++]=255&t;return 2===s&&(t=n[e.charCodeAt(r)]<<2|n[e.charCodeAt(r+1)]>>4,l[u++]=255&t),1===s&&(t=n[e.charCodeAt(r)]<<10|n[e.charCodeAt(r+1)]<<4|n[e.charCodeAt(r+2)]>>2,l[u++]=t>>8&255,l[u++]=255&t),l},t.fromByteArray=function(e){for(var t,n=e.length,a=n%3,i=[],o=0,s=n-a;o<s;o+=16383)i.push(function(e,t,n){for(var a,i=[],o=t;o<n;o+=3)i.push(r[(a=(e[o]<<16&16711680)+(e[o+1]<<8&65280)+(255&e[o+2]))>>18&63]+r[a>>12&63]+r[a>>6&63]+r[63&a]);return i.join("")}(e,o,o+16383>s?s:o+16383));return 1===a?i.push(r[(t=e[n-1])>>2]+r[t<<4&63]+"=="):2===a&&i.push(r[(t=(e[n-2]<<8)+e[n-1])>>10]+r[t>>4&63]+r[t<<2&63]+"="),i.join("")};for(var r=[],n=[],a="undefined"!=typeof Uint8Array?Uint8Array:Array,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,s=i.length;o<s;++o)r[o]=i[o],n[i.charCodeAt(o)]=o;function f(e){var t=e.length;if(t%4>0)throw Error("Invalid string. Length must be a multiple of 4");var r=e.indexOf("=");-1===r&&(r=t);var n=r===t?0:4-r%4;return[r,n]}n["-".charCodeAt(0)]=62,n["_".charCodeAt(0)]=63},72:function(e,t,r){"use strict";/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var n=r(675),a=r(783),i="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;function o(e){if(e>2147483647)throw RangeError('The value "'+e+'" is invalid for option "size"');var t=new Uint8Array(e);return Object.setPrototypeOf(t,s.prototype),t}function s(e,t,r){if("number"==typeof e){if("string"==typeof t)throw TypeError('The "string" argument must be of type string. Received type number');return u(e)}return f(e,t,r)}function f(e,t,r){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!s.isEncoding(t))throw TypeError("Unknown encoding: "+t);var r=0|h(e,t),n=o(r),a=n.write(e,t);return a!==r&&(n=n.slice(0,a)),n}(e,t);if(ArrayBuffer.isView(e))return c(e);if(null==e)throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(B(e,ArrayBuffer)||e&&B(e.buffer,ArrayBuffer)||"undefined"!=typeof SharedArrayBuffer&&(B(e,SharedArrayBuffer)||e&&B(e.buffer,SharedArrayBuffer)))return function(e,t,r){var n;if(t<0||e.byteLength<t)throw RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(r||0))throw RangeError('"length" is outside of buffer bounds');return Object.setPrototypeOf(n=void 0===t&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,t):new Uint8Array(e,t,r),s.prototype),n}(e,t,r);if("number"==typeof e)throw TypeError('The "value" argument must not be of type number. Received type number');var n=e.valueOf&&e.valueOf();if(null!=n&&n!==e)return s.from(n,t,r);var a=function(e){if(s.isBuffer(e)){var t,r=0|d(e.length),n=o(r);return 0===n.length||e.copy(n,0,0,r),n}return void 0!==e.length?"number"!=typeof e.length||(t=e.length)!=t?o(0):c(e):"Buffer"===e.type&&Array.isArray(e.data)?c(e.data):void 0}(e);if(a)return a;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return s.from(e[Symbol.toPrimitive]("string"),t,r);throw TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw TypeError('"size" argument must be of type number');if(e<0)throw RangeError('The value "'+e+'" is invalid for option "size"')}function u(e){return l(e),o(e<0?0:0|d(e))}function c(e){for(var t=e.length<0?0:0|d(e.length),r=o(t),n=0;n<t;n+=1)r[n]=255&e[n];return r}function d(e){if(e>=2147483647)throw RangeError("Attempt to allocate Buffer larger than maximum size: 0x7fffffff bytes");return 0|e}function h(e,t){if(s.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||B(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);var r=e.length,n=arguments.length>2&&!0===arguments[2];if(!n&&0===r)return 0;for(var a=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return x(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return D(e).length;default:if(a)return n?-1:x(e).length;t=(""+t).toLowerCase(),a=!0}}function m(e,t,r){var a,i,o=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===r||r>this.length)&&(r=this.length),r<=0||(r>>>=0)<=(t>>>=0)))return"";for(e||(e="utf8");;)switch(e){case"hex":return function(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var a="",i=t;i<r;++i)a+=U[e[i]];return a}(this,t,r);case"utf8":case"utf-8":return v(this,t,r);case"ascii":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(127&e[a]);return n}(this,t,r);case"latin1":case"binary":return function(e,t,r){var n="";r=Math.min(e.length,r);for(var a=t;a<r;++a)n+=String.fromCharCode(e[a]);return n}(this,t,r);case"base64":return a=t,i=r,0===a&&i===this.length?n.fromByteArray(this):n.fromByteArray(this.slice(a,i));case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return function(e,t,r){for(var n=e.slice(t,r),a="",i=0;i<n.length;i+=2)a+=String.fromCharCode(n[i]+256*n[i+1]);return a}(this,t,r);default:if(o)throw TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),o=!0}}function g(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function p(e,t,r,n,a){var i;if(0===e.length)return -1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),(i=r=+r)!=i&&(r=a?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(a)return -1;r=e.length-1}else if(r<0){if(!a)return -1;r=0}if("string"==typeof t&&(t=s.from(t,n)),s.isBuffer(t))return 0===t.length?-1:y(e,t,r,n,a);if("number"==typeof t)return(t&=255,"function"==typeof Uint8Array.prototype.indexOf)?a?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):y(e,[t],r,n,a);throw TypeError("val must be string, number or Buffer")}function y(e,t,r,n,a){var i,o=1,s=e.length,f=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return -1;o=2,s/=2,f/=2,r/=2}function l(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(a){var u=-1;for(i=r;i<s;i++)if(l(e,i)===l(t,-1===u?0:i-u)){if(-1===u&&(u=i),i-u+1===f)return u*o}else -1!==u&&(i-=i-u),u=-1}else for(r+f>s&&(r=s-f),i=r;i>=0;i--){for(var c=!0,d=0;d<f;d++)if(l(e,i+d)!==l(t,d)){c=!1;break}if(c)return i}return -1}function v(e,t,r){r=Math.min(e.length,r);for(var n=[],a=t;a<r;){var i,o,s,f,l=e[a],u=null,c=l>239?4:l>223?3:l>191?2:1;if(a+c<=r)switch(c){case 1:l<128&&(u=l);break;case 2:(192&(i=e[a+1]))==128&&(f=(31&l)<<6|63&i)>127&&(u=f);break;case 3:i=e[a+1],o=e[a+2],(192&i)==128&&(192&o)==128&&(f=(15&l)<<12|(63&i)<<6|63&o)>2047&&(f<55296||f>57343)&&(u=f);break;case 4:i=e[a+1],o=e[a+2],s=e[a+3],(192&i)==128&&(192&o)==128&&(192&s)==128&&(f=(15&l)<<18|(63&i)<<12|(63&o)<<6|63&s)>65535&&f<1114112&&(u=f)}null===u?(u=65533,c=1):u>65535&&(u-=65536,n.push(u>>>10&1023|55296),u=56320|1023&u),n.push(u),a+=c}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=4096));return r}(n)}function b(e,t,r){if(e%1!=0||e<0)throw RangeError("offset is not uint");if(e+t>r)throw RangeError("Trying to access beyond buffer length")}function w(e,t,r,n,a,i){if(!s.isBuffer(e))throw TypeError('"buffer" argument must be a Buffer instance');if(t>a||t<i)throw RangeError('"value" argument is out of bounds');if(r+n>e.length)throw RangeError("Index out of range")}function P(e,t,r,n,a,i){if(r+n>e.length||r<0)throw RangeError("Index out of range")}function E(e,t,r,n,i){return t=+t,r>>>=0,i||P(e,t,r,4,34028234663852886e22,-34028234663852886e22),a.write(e,t,r,n,23,4),r+4}function I(e,t,r,n,i){return t=+t,r>>>=0,i||P(e,t,r,8,17976931348623157e292,-17976931348623157e292),a.write(e,t,r,n,52,8),r+8}t.Buffer=s,t.SlowBuffer=function(e){return+e!=e&&(e=0),s.alloc(+e)},t.INSPECT_MAX_BYTES=50,t.kMaxLength=2147483647,s.TYPED_ARRAY_SUPPORT=function(){try{var e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(e,t,r){return f(e,t,r)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(e,t,r){return(l(e),e<=0)?o(e):void 0!==t?"string"==typeof r?o(e).fill(t,r):o(e).fill(t):o(e)},s.allocUnsafe=function(e){return u(e)},s.allocUnsafeSlow=function(e){return u(e)},s.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==s.prototype},s.compare=function(e,t){if(B(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),B(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(e)||!s.isBuffer(t))throw TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;for(var r=e.length,n=t.length,a=0,i=Math.min(r,n);a<i;++a)if(e[a]!==t[a]){r=e[a],n=t[a];break}return r<n?-1:n<r?1:0},s.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(e,t){if(!Array.isArray(e))throw TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return s.alloc(0);if(void 0===t)for(r=0,t=0;r<e.length;++r)t+=e[r].length;var r,n=s.allocUnsafe(t),a=0;for(r=0;r<e.length;++r){var i=e[r];if(B(i,Uint8Array)&&(i=s.from(i)),!s.isBuffer(i))throw TypeError('"list" argument must be an Array of Buffers');i.copy(n,a),a+=i.length}return n},s.byteLength=h,s.prototype._isBuffer=!0,s.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)g(this,t,t+1);return this},s.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},s.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},s.prototype.toString=function(){var e=this.length;return 0===e?"":0==arguments.length?v(this,0,e):m.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(e){if(!s.isBuffer(e))throw TypeError("Argument must be a Buffer");return this===e||0===s.compare(this,e)},s.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"},i&&(s.prototype[i]=s.prototype.inspect),s.prototype.compare=function(e,t,r,n,a){if(B(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(e))throw TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===a&&(a=this.length),t<0||r>e.length||n<0||a>this.length)throw RangeError("out of range index");if(n>=a&&t>=r)return 0;if(n>=a)return -1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,a>>>=0,this===e)return 0;for(var i=a-n,o=r-t,f=Math.min(i,o),l=this.slice(n,a),u=e.slice(t,r),c=0;c<f;++c)if(l[c]!==u[c]){i=l[c],o=u[c];break}return i<o?-1:o<i?1:0},s.prototype.includes=function(e,t,r){return -1!==this.indexOf(e,t,r)},s.prototype.indexOf=function(e,t,r){return p(this,e,t,r,!0)},s.prototype.lastIndexOf=function(e,t,r){return p(this,e,t,r,!1)},s.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else if(isFinite(t))t>>>=0,isFinite(r)?(r>>>=0,void 0===n&&(n="utf8")):(n=r,r=void 0);else throw Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var a,i,o,s,f,l,u,c,d,h,m,g,p=this.length-t;if((void 0===r||r>p)&&(r=p),e.length>0&&(r<0||t<0)||t>this.length)throw RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var y=!1;;)switch(n){case"hex":return function(e,t,r,n){r=Number(r)||0;var a=e.length-r;n?(n=Number(n))>a&&(n=a):n=a;var i=t.length;n>i/2&&(n=i/2);for(var o=0;o<n;++o){var s=parseInt(t.substr(2*o,2),16);if(s!=s)break;e[r+o]=s}return o}(this,e,t,r);case"utf8":case"utf-8":return f=t,l=r,T(x(e,this.length-f),this,f,l);case"ascii":return u=t,c=r,T(S(e),this,u,c);case"latin1":case"binary":return a=this,i=e,o=t,s=r,T(S(i),a,o,s);case"base64":return d=t,h=r,T(D(e),this,d,h);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return m=t,g=r,T(function(e,t){for(var r,n,a=[],i=0;i<e.length&&!((t-=2)<0);++i)n=(r=e.charCodeAt(i))>>8,a.push(r%256),a.push(n);return a}(e,this.length-m),this,m,g);default:if(y)throw TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),y=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},s.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n=this.subarray(e,t);return Object.setPrototypeOf(n,s.prototype),n},s.prototype.readUIntLE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n},s.prototype.readUIntBE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var n=this[e+--t],a=1;t>0&&(a*=256);)n+=this[e+--t]*a;return n},s.prototype.readUInt8=function(e,t){return e>>>=0,t||b(e,1,this.length),this[e]},s.prototype.readUInt16LE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]|this[e+1]<<8},s.prototype.readUInt16BE=function(e,t){return e>>>=0,t||b(e,2,this.length),this[e]<<8|this[e+1]},s.prototype.readUInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},s.prototype.readUInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},s.prototype.readIntLE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var n=this[e],a=1,i=0;++i<t&&(a*=256);)n+=this[e+i]*a;return n>=(a*=128)&&(n-=Math.pow(2,8*t)),n},s.prototype.readIntBE=function(e,t,r){e>>>=0,t>>>=0,r||b(e,t,this.length);for(var n=t,a=1,i=this[e+--n];n>0&&(a*=256);)i+=this[e+--n]*a;return i>=(a*=128)&&(i-=Math.pow(2,8*t)),i},s.prototype.readInt8=function(e,t){return(e>>>=0,t||b(e,1,this.length),128&this[e])?-((255-this[e]+1)*1):this[e]},s.prototype.readInt16LE=function(e,t){e>>>=0,t||b(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt16BE=function(e,t){e>>>=0,t||b(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},s.prototype.readInt32LE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},s.prototype.readInt32BE=function(e,t){return e>>>=0,t||b(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},s.prototype.readFloatLE=function(e,t){return e>>>=0,t||b(e,4,this.length),a.read(this,e,!0,23,4)},s.prototype.readFloatBE=function(e,t){return e>>>=0,t||b(e,4,this.length),a.read(this,e,!1,23,4)},s.prototype.readDoubleLE=function(e,t){return e>>>=0,t||b(e,8,this.length),a.read(this,e,!0,52,8)},s.prototype.readDoubleBE=function(e,t){return e>>>=0,t||b(e,8,this.length),a.read(this,e,!1,52,8)},s.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){var a=Math.pow(2,8*r)-1;w(this,e,t,r,a,0)}var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},s.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t>>>=0,r>>>=0,!n){var a=Math.pow(2,8*r)-1;w(this,e,t,r,a,0)}var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},s.prototype.writeUInt8=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,1,255,0),this[t]=255&e,t+1},s.prototype.writeUInt16LE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeUInt16BE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeUInt32LE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},s.prototype.writeUInt32BE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var a=Math.pow(2,8*r-1);w(this,e,t,r,a-1,-a)}var i=0,o=1,s=0;for(this[t]=255&e;++i<r&&(o*=256);)e<0&&0===s&&0!==this[t+i-1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+r},s.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t>>>=0,!n){var a=Math.pow(2,8*r-1);w(this,e,t,r,a-1,-a)}var i=r-1,o=1,s=0;for(this[t+i]=255&e;--i>=0&&(o*=256);)e<0&&0===s&&0!==this[t+i+1]&&(s=1),this[t+i]=(e/o>>0)-s&255;return t+r},s.prototype.writeInt8=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},s.prototype.writeInt16LE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},s.prototype.writeInt16BE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},s.prototype.writeInt32LE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},s.prototype.writeInt32BE=function(e,t,r){return e=+e,t>>>=0,r||w(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},s.prototype.writeFloatLE=function(e,t,r){return E(this,e,t,!0,r)},s.prototype.writeFloatBE=function(e,t,r){return E(this,e,t,!1,r)},s.prototype.writeDoubleLE=function(e,t,r){return I(this,e,t,!0,r)},s.prototype.writeDoubleBE=function(e,t,r){return I(this,e,t,!1,r)},s.prototype.copy=function(e,t,r,n){if(!s.isBuffer(e))throw TypeError("argument should be a Buffer");if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r||0===e.length||0===this.length)return 0;if(t<0)throw RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw RangeError("Index out of range");if(n<0)throw RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var a=n-r;if(this===e&&"function"==typeof Uint8Array.prototype.copyWithin)this.copyWithin(t,r,n);else if(this===e&&r<t&&t<n)for(var i=a-1;i>=0;--i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,n),t);return a},s.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),void 0!==n&&"string"!=typeof n)throw TypeError("encoding must be a string");if("string"==typeof n&&!s.isEncoding(n))throw TypeError("Unknown encoding: "+n);if(1===e.length){var a,i=e.charCodeAt(0);("utf8"===n&&i<128||"latin1"===n)&&(e=i)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<r)throw RangeError("Out of range index");if(r<=t)return this;if(t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0),"number"==typeof e)for(a=t;a<r;++a)this[a]=e;else{var o=s.isBuffer(e)?e:s.from(e,n),f=o.length;if(0===f)throw TypeError('The value "'+e+'" is invalid for argument "value"');for(a=0;a<r-t;++a)this[a+t]=o[a%f]}return this};var A=/[^+/0-9A-Za-z-_]/g;function x(e,t){t=t||1/0;for(var r,n=e.length,a=null,i=[],o=0;o<n;++o){if((r=e.charCodeAt(o))>55295&&r<57344){if(!a){if(r>56319||o+1===n){(t-=3)>-1&&i.push(239,191,189);continue}a=r;continue}if(r<56320){(t-=3)>-1&&i.push(239,191,189),a=r;continue}r=(a-55296<<10|r-56320)+65536}else a&&(t-=3)>-1&&i.push(239,191,189);if(a=null,r<128){if((t-=1)<0)break;i.push(r)}else if(r<2048){if((t-=2)<0)break;i.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;i.push(r>>12|224,r>>6&63|128,63&r|128)}else if(r<1114112){if((t-=4)<0)break;i.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}else throw Error("Invalid code point")}return i}function S(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function D(e){return n.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(A,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function T(e,t,r,n){for(var a=0;a<n&&!(a+r>=t.length)&&!(a>=e.length);++a)t[a+r]=e[a];return a}function B(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}var U=function(){for(var e="0123456789abcdef",t=Array(256),r=0;r<16;++r)for(var n=16*r,a=0;a<16;++a)t[n+a]=e[r]+e[a];return t}()},783:function(e,t){/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */t.read=function(e,t,r,n,a){var i,o,s=8*a-n-1,f=(1<<s)-1,l=f>>1,u=-7,c=r?a-1:0,d=r?-1:1,h=e[t+c];for(c+=d,i=h&(1<<-u)-1,h>>=-u,u+=s;u>0;i=256*i+e[t+c],c+=d,u-=8);for(o=i&(1<<-u)-1,i>>=-u,u+=n;u>0;o=256*o+e[t+c],c+=d,u-=8);if(0===i)i=1-l;else{if(i===f)return o?NaN:(h?-1:1)*(1/0);o+=Math.pow(2,n),i-=l}return(h?-1:1)*o*Math.pow(2,i-n)},t.write=function(e,t,r,n,a,i){var o,s,f,l=8*i-a-1,u=(1<<l)-1,c=u>>1,d=23===a?5960464477539062e-23:0,h=n?0:i-1,m=n?1:-1,g=t<0||0===t&&1/t<0?1:0;for(isNaN(t=Math.abs(t))||t===1/0?(s=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(f=Math.pow(2,-o))<1&&(o--,f*=2),o+c>=1?t+=d/f:t+=d*Math.pow(2,1-c),t*f>=2&&(o++,f/=2),o+c>=u?(s=0,o=u):o+c>=1?(s=(t*f-1)*Math.pow(2,a),o+=c):(s=t*Math.pow(2,c-1)*Math.pow(2,a),o=0));a>=8;e[r+h]=255&s,h+=m,s/=256,a-=8);for(o=o<<a|s,l+=a;l>0;e[r+h]=255&o,h+=m,o/=256,l-=8);e[r+h-m]|=128*g}}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var i=r[e]={exports:{}},o=!0;try{t[e](i,i.exports,n),o=!1}finally{o&&delete r[e]}return i.exports}n.ab="//";var a=n(72);e.exports=a}()},77663:function(e){!function(){var t={229:function(e){var t,r,n,a=e.exports={};function i(){throw Error("setTimeout has not been defined")}function o(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:o}catch(e){r=o}}();var f=[],l=!1,u=-1;function c(){l&&n&&(l=!1,n.length?f=n.concat(f):u=-1,f.length&&d())}function d(){if(!l){var e=s(c);l=!0;for(var t=f.length;t;){for(n=f,f=[];++u<t;)n&&n[u].run();u=-1,t=f.length}n=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===o||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function m(){}a.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];f.push(new h(e,t)),1!==f.length||l||s(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=m,a.addListener=m,a.once=m,a.off=m,a.removeListener=m,a.removeAllListeners=m,a.emit=m,a.prependListener=m,a.prependOnceListener=m,a.listeners=function(e){return[]},a.binding=function(e){throw Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw Error("process.chdir is not supported")},a.umask=function(){return 0}}},r={};function n(e){var a=r[e];if(void 0!==a)return a.exports;var i=r[e]={exports:{}},o=!0;try{t[e](i,i.exports,n),o=!1}finally{o&&delete r[e]}return i.exports}n.ab="//";var a=n(229);e.exports=a}()}}]);